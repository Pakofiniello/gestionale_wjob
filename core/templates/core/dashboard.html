{% extends "core/base.html" %}

{% block title %}Dashboard - Gestionale Magazzino{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block content %}
<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                </svg>
            </div>
            <span class="stat-change positive">+12%</span>
        </div>
        <div class="stat-value">1,247</div>
        <div class="stat-label">Prodotti Totali</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
            </div>
            <span class="stat-change positive">+8%</span>
        </div>
        <div class="stat-value">342</div>
        <div class="stat-label">Ordini Mensili</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="1" x2="12" y2="23"/>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
            </div>
            <span class="stat-change positive">+23%</span>
        </div>
        <div class="stat-value">€89,432</div>
        <div class="stat-label">Fatturato Mensile</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                </svg>
            </div>
            <span class="stat-change negative">-3%</span>
        </div>
        <div class="stat-value">23</div>
        <div class="stat-label">Prodotti in Esaurimento</div>
    </div>
</div>

<!-- Charts Section -->
<div class="chart-container">
    <div class="chart-header">
        <h3 class="chart-title">Vendite Ultimi 6 Mesi</h3>
        <div class="btn-group">
            <button class="btn btn-sm btn-secondary active">6 Mesi</button>
            <button class="btn btn-sm btn-secondary">12 Mesi</button>
        </div>
    </div>
    <div class="chart-wrapper">
        <canvas id="salesChart"></canvas>
    </div>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px; margin-top: 24px;">
    <!-- Recent Orders -->
    <div class="table-container">
        <div class="table-header">
            <h3 class="table-title">Ordini Recenti</h3>
            <a href="orders.html" class="btn btn-sm btn-secondary">Vedi Tutti</a>
        </div>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Numero Ordine</th>
                        <th>Cliente</th>
                        <th>Data</th>
                        <th>Totale</th>
                        <th>Stato</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ORD-2026-087</strong></td>
                        <td>Mario Rossi</td>
                        <td>07/01/2026</td>
                        <td><strong>€1,299.99</strong></td>
                        <td><span class="badge badge-warning">In Attesa</span></td>
                    </tr>
                    <tr>
                        <td><strong>ORD-2026-086</strong></td>
                        <td>Laura Bianchi</td>
                        <td>07/01/2026</td>
                        <td><strong>€449.99</strong></td>
                        <td><span class="badge badge-success">Spedito</span></td>
                    </tr>
                    <tr>
                        <td><strong>ORD-2026-085</strong></td>
                        <td>Giuseppe Verdi</td>
                        <td>06/01/2026</td>
                        <td><strong>€899.50</strong></td>
                        <td><span class="badge badge-success">Consegnato</span></td>
                    </tr>
                    <tr>
                        <td><strong>ORD-2026-084</strong></td>
                        <td>Anna Neri</td>
                        <td>06/01/2026</td>
                        <td><strong>€2,150.00</strong></td>
                        <td><span class="badge badge-info">In Lavorazione</span></td>
                    </tr>
                    <tr>
                        <td><strong>ORD-2026-083</strong></td>
                        <td>Paolo Gialli</td>
                        <td>05/01/2026</td>
                        <td><strong>€674.99</strong></td>
                        <td><span class="badge badge-success">Consegnato</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Top Products -->
    <div class="table-container">
        <div class="table-header">
            <h3 class="table-title">Prodotti Top</h3>
        </div>
        <div style="padding: 24px;">
            <div style="display: flex; flex-direction: column; gap: 16px;">
                <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-hover); border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 8px;"></div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; font-size: 14px;">Laptop Dell XPS</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">156 vendite</div>
                    </div>
                    <div style="font-weight: 700; color: var(--primary-dark);">€1,299</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-hover); border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--accent), var(--warning)); border-radius: 8px;"></div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; font-size: 14px;">Monitor 4K</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">142 vendite</div>
                    </div>
                    <div style="font-weight: 700; color: var(--primary-dark);">€449</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-hover); border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--info), var(--primary)); border-radius: 8px;"></div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; font-size: 14px;">Tastiera Meccanica</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">128 vendite</div>
                    </div>
                    <div style="font-weight: 700; color: var(--primary-dark);">€149</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-hover); border-radius: 8px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--secondary), var(--accent-light)); border-radius: 8px;"></div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; font-size: 14px;">Mouse Wireless</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">98 vendite</div>
                    </div>
                    <div style="font-weight: 700; color: var(--primary-dark);">€79</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Low Stock Alert -->
<div class="table-container" style="margin-top: 24px;">
    <div class="table-header">
        <h3 class="table-title">⚠️ Prodotti in Esaurimento</h3>
        <button class="btn btn-sm btn-primary">Riordina Tutto</button>
    </div>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Prodotto</th>
                    <th>SKU</th>
                    <th>Categoria</th>
                    <th>Stock Attuale</th>
                    <th>Soglia Minima</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Mouse Wireless Pro</strong></td>
                    <td>MOU-WL-003</td>
                    <td>Accessori</td>
                    <td><span class="badge badge-error">3 unità</span></td>
                    <td>10</td>
                    <td><button class="btn btn-sm btn-primary">Riordina</button></td>
                </tr>
                <tr>
                    <td><strong>Cavo HDMI 2m</strong></td>
                    <td>CAB-HDMI-002</td>
                    <td>Cavi</td>
                    <td><span class="badge badge-warning">8 unità</span></td>
                    <td>20</td>
                    <td><button class="btn btn-sm btn-primary">Riordina</button></td>
                </tr>
                <tr>
                    <td><strong>Webcam HD</strong></td>
                    <td>CAM-HD-001</td>
                    <td>Periferiche</td>
                    <td><span class="badge badge-error">5 unità</span></td>
                    <td>15</td>
                    <td><button class="btn btn-sm btn-primary">Riordina</button></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Inizializza grafico vendite
document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('salesChart');
    if (ctx) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio'],
                datasets: [{
                    label: 'Vendite (€)',
                    data: [65000, 72000, 68000, 85000, 92000, 89432],
                    borderColor: 'rgb(124, 152, 133)',
                    backgroundColor: 'rgba(124, 152, 133, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '€' + value.toLocaleString('it-IT');
                            }
                        }
                    }
                }
            }
        });
    }
});
</script>
{% endblock %}
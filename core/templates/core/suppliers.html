{% extends "core/base.html" %}

{% block title %}Fornitori - Gestionale Magazzino{% endblock %}
{% block page_title %}Fornitori{% endblock %}

{% block content %}
<!-- Header con azioni -->
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
    <div>
        <p style="color: var(--text-secondary); margin-top: 8px;">Gestisci i fornitori e le relazioni commerciali</p>
    </div>
    <button class="btn btn-primary" onclick="openAddSupplierModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Aggiungi Fornitore
    </button>
</div>

<!-- Stats Fornitori -->
<div class="stats-grid" style="margin-bottom: 32px;">
    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon" style="background: linear-gradient(135deg, #7C9885, #A8C4B3);">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="8.5" cy="7" r="4"/>
                    <polyline points="17 11 19 13 23 9"/>
                </svg>
            </div>
        </div>
        <div class="stat-value">28</div>
        <div class="stat-label">Fornitori Attivi</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon" style="background: linear-gradient(135deg, #6B9E78, #8FBC99);">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
            </div>
            <span class="stat-change positive">+15%</span>
        </div>
        <div class="stat-value">156</div>
        <div class="stat-label">Ordini Fornitori</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon" style="background: linear-gradient(135deg, #7C98B6, #9BB0CD);">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="1" x2="12" y2="23"/>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
            </div>
        </div>
        <div class="stat-value">€234,567</div>
        <div class="stat-label">Spesa Totale</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-icon" style="background: linear-gradient(135deg, #D4B5A0, #E8A87C);">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                    <polyline points="17 6 23 6 23 12"/>
                </svg>
            </div>
        </div>
        <div class="stat-value">97.2%</div>
        <div class="stat-label">Tasso Puntualità</div>
    </div>
</div>

<!-- Filtri -->
<div class="table-container" style="margin-bottom: 24px;">
    <div style="padding: 20px; display: flex; gap: 16px; flex-wrap: wrap; align-items: center;">
        <div class="search-box" style="flex: 1; min-width: 250px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.35-4.35"/>
            </svg>
            <input type="text" placeholder="Cerca fornitori..." id="supplierSearch">
        </div>
        
        <select class="form-select" style="width: 180px;">
            <option value="">Tutte le categorie</option>
            <option value="elettronica">Elettronica</option>
            <option value="arredamento">Arredamento</option>
            <option value="accessori">Accessori</option>
        </select>
        
        <select class="form-select" style="width: 160px;">
            <option value="">Tutti gli stati</option>
            <option value="active">Attivo</option>
            <option value="inactive">Inattivo</option>
        </select>
    </div>
</div>

<!-- Griglia Fornitori -->
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 24px; margin-bottom: 32px;">
    <!-- Supplier Card 1 -->
    <div class="table-container">
        <div style="padding: 24px;">
            <div style="display: flex; align-items: start; gap: 16px; margin-bottom: 16px;">
                <div style="width: 60px; height: 60px; border-radius: 12px; background: linear-gradient(135deg, #7C9885, #A8C4B3); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 24px;">
                    TI
                </div>
                <div style="flex: 1;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">TechItalia SpA</h3>
                    <div style="font-size: 13px; color: var(--text-secondary);">Elettronica • Hardware</div>
                    <span class="badge badge-success" style="margin-top: 8px;">Attivo</span>
                </div>
            </div>
            
            <div style="display: grid; gap: 12px; margin-bottom: 16px;">
                <div style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <span style="color: var(--text-secondary);">info@techitalia.it</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                    </svg>
                    <span style="color: var(--text-secondary);">+39 02 1234567</span>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; padding-top: 16px; border-top: var(--border);">
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary-dark);">42</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Ordini</div>
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary-dark);">€89,450</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Spesa Totale</div>
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--success);">98%</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Puntualità</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 8px; margin-top: 16px;">
                <button class="btn btn-sm btn-primary" style="flex: 1;" onclick="viewSupplier(1)">Dettagli</button>
                <button class="btn btn-sm btn-secondary" onclick="newOrder(1)">Nuovo Ordine</button>
            </div>
        </div>
    </div>

    <!-- Supplier Card 2 -->
    <div class="table-container">
        <div style="padding: 24px;">
            <div style="display: flex; align-items: start; gap: 16px; margin-bottom: 16px;">
                <div style="width: 60px; height: 60px; border-radius: 12px; background: linear-gradient(135deg, #D4B5A0, #E8A87C); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 24px;">
                    OF
                </div>
                <div style="flex: 1;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">OfficeFurn Srl</h3>
                    <div style="font-size: 13px; color: var(--text-secondary);">Arredamento • Ufficio</div>
                    <span class="badge badge-success" style="margin-top: 8px;">Attivo</span>
                </div>
            </div>
            
            <div style="display: grid; gap: 12px; margin-bottom: 16px;">
                <div style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <span style="color: var(--text-secondary);">vendite@officefurn.it</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                    </svg>
                    <span style="color: var(--text-secondary);">+39 06 9876543</span>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; padding-top: 16px; border-top: var(--border);">
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary-dark);">28</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Ordini</div>
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary-dark);">€45,200</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Spesa Totale</div>
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--success);">95%</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Puntualità</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 8px; margin-top: 16px;">
                <button class="btn btn-sm btn-primary" style="flex: 1;" onclick="viewSupplier(2)">Dettagli</button>
                <button class="btn btn-sm btn-secondary" onclick="newOrder(2)">Nuovo Ordine</button>
            </div>
        </div>
    </div>

    <!-- Supplier Card 3 -->
    <div class="table-container">
        <div style="padding: 24px;">
            <div style="display: flex; align-items: start; gap: 16px; margin-bottom: 16px;">
                <div style="width: 60px; height: 60px; border-radius: 12px; background: linear-gradient(135deg, #7C98B6, #9BB0CD); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 24px;">
                    AC
                </div>
                <div style="flex: 1;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">AccessoriPlus</h3>
                    <div style="font-size: 13px; color: var(--text-secondary);">Accessori • Periferiche</div>
                    <span class="badge badge-success" style="margin-top: 8px;">Attivo</span>
                </div>
            </div>
            
            <div style="display: grid; gap: 12px; margin-bottom: 16px;">
                <div style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <span style="color: var(--text-secondary);">ordini@accessoriplus.it</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                    </svg>
                    <span style="color: var(--text-secondary);">+39 011 5554321</span>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; padding-top: 16px; border-top: var(--border);">
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary-dark);">65</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Ordini</div>
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary-dark);">€28,900</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Spesa Totale</div>
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--success);">99%</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Puntualità</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 8px; margin-top: 16px;">
                <button class="btn btn-sm btn-primary" style="flex: 1;" onclick="viewSupplier(3)">Dettagli</button>
                <button class="btn btn-sm btn-secondary" onclick="newOrder(3)">Nuovo Ordine</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Aggiungi Fornitore -->
<div class="modal-overlay" id="addSupplierModal">
    <div class="modal">
        <div class="modal-header">
            <h2 class="modal-title">Aggiungi Nuovo Fornitore</h2>
            <button class="modal-close" onclick="closeAddSupplierModal()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <form id="addSupplierForm">
                <div class="form-group">
                    <label class="form-label">Ragione Sociale</label>
                    <input type="text" class="form-input" name="company_name" required>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label class="form-label">Partita IVA</label>
                        <input type="text" class="form-input" name="vat_number" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Categoria</label>
                        <select class="form-select" name="category" required>
                            <option value="">Seleziona...</option>
                            <option value="elettronica">Elettronica</option>
                            <option value="arredamento">Arredamento</option>
                            <option value="accessori">Accessori</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Telefono</label>
                        <input type="tel" class="form-input" name="phone" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Indirizzo</label>
                    <textarea class="form-textarea" name="address" rows="2"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Note</label>
                    <textarea class="form-textarea" name="notes" rows="3"></textarea>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeAddSupplierModal()">Annulla</button>
            <button class="btn btn-primary" onclick="saveSupplier()">Salva Fornitore</button>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
function openAddSupplierModal() {
    document.getElementById('addSupplierModal').classList.add('active');
}

function closeAddSupplierModal() {
    document.getElementById('addSupplierModal').classList.remove('active');
}

function saveSupplier() {
    const form = document.getElementById('addSupplierForm');
    if (Form.validate(form)) {
        const data = Form.serialize(form);
        Toast.show('Fornitore aggiunto con successo', 'success');
        closeAddSupplierModal();
        Form.reset(form);
    }
}

function viewSupplier(id) {
    Toast.show(`Visualizzazione dettagli fornitore #${id}`, 'info');
}

function newOrder(supplierId) {
    Toast.show(`Creazione nuovo ordine per fornitore #${supplierId}`, 'info');
}

// Ricerca fornitori
document.getElementById('supplierSearch')?.addEventListener('input', function(e) {
    // Implementa logica di ricerca
});
</script>
{% endblock %}